import{d as R,u as B,r as V,V as b,o as x,b as m,e as C,I as M,k as s,i as c,w as u,a9 as N,aa as S,l as z,t as E,a1 as p,U as r}from"./index-CfDPjNFe.js";import{c as I,d as P}from"./stat-Cg5zsjIG.js";const F={class:"p-3 mt-3 app-block"},L={class:"p-3 mt-3 app-block"},q={class:"p-3 mt-3 app-block"},$=R({__name:"VisitRegion",setup(O){const{t:d,n:v}=B(),y=V("last30day"),Y=e=>{switch(e){case"today":return r().format("YYYY-MM-DD");case"yesterday":return r().subtract(1,"day").format("YYYY-MM-DD");case"last7day":return r().subtract(6,"day").format("YYYY-MM-DD");case"last30day":return r().subtract(29,"day").format("YYYY-MM-DD");case"lastYear":return r().subtract(1,"year").format("YYYY-MM-DD");default:return}},_=e=>e==="yesterday"?r().subtract(1,"day").format("YYYY-MM-DD"):r().format("YYYY-MM-DD"),g=b(),w=async e=>{const n=await I({begin:Y(e),end:_(e)}),l=n.reduce((t,f)=>t+Number(f.pvCount),0),i={title:{text:d("menu.stat.visitCountry"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>v(t*100/l,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitCountry"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:Number(t.pvCount),name:t.name}))}]},o=g.value;if(o==null)return;let a=p.getInstanceByDom(o);a==null&&(a=p.init(o)),a.setOption(i),window.addEventListener("resize",function(){a&&a.resize()})},h=b(),k=async e=>{const n=await P({begin:Y(e),end:_(e)}),l=n.reduce((t,f)=>t+Number(f.pvCount),0),i={title:{text:d("menu.stat.visitProvince"),textStyle:{color:"#909399",fontWeight:"normal",fontSize:16}},tooltip:{trigger:"item",valueFormatter:t=>v(t*100/l,"decimal")+"%"},legend:{type:"scroll",orient:"vertical",right:"10%",top:16,bottom:16},series:[{name:d("menu.stat.visitProvince"),type:"pie",radius:"72%",center:["40%","56%"],data:n.map(t=>({value:Number(t.pvCount),name:t.name}))}]},o=h.value;if(o==null)return;let a=p.getInstanceByDom(o);a==null&&(a=p.init(o)),a.setOption(i),window.addEventListener("resize",function(){a&&a.resize()})},D=async e=>{w(e),k(e)};return x(async()=>{D(y.value)}),(e,n)=>{const l=m("el-radio-button"),i=m("el-radio-group"),o=m("el-col"),a=m("el-row");return C(),M("div",null,[s("div",F,[s("div",null,[c(i,{modelValue:y.value,"onUpdate:modelValue":n[0]||(n[0]=t=>y.value=t),onChange:n[1]||(n[1]=t=>D(t))},{default:u(()=>[(C(),M(N,null,S(["today","yesterday","last7day","last30day","lastYear","all"],t=>c(l,{key:t,value:t},{default:u(()=>[z(E(e.$t("visit.".concat(t))),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"])])]),c(a,{gutter:12},{default:u(()=>[c(o,{span:12},{default:u(()=>[s("div",L,[s("div",{ref_key:"countryChartRef",ref:g,class:"h-80"},null,512)])]),_:1}),c(o,{span:12},{default:u(()=>[s("div",q,[s("div",{ref_key:"provinceChartRef",ref:h,class:"h-80"},null,512)])]),_:1})]),_:1})])}}});export{$ as default};
